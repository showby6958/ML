# k-fold cross validation(k겹 교차 검증)

k겹 교차 검증은 머신 러닝의 성능을 조금 더 정확하게 평가할 수 있는 방법입니다.

- 주어진 데이터를 training set과 test set으로 나누는데요, training set은 모델이 인풋 변수를 이용해서 아웃풋 변수를 예측할 수 있도록 학습시키는데 사용하고, 
test set은 학습시킨 모델이 얼마나 예측을 잘 하는지, 다르게 말해서 모델의 성능이 얼마나 좋은지 파악하기 위해서 씁니다.

이 방법에서는 발생할 수 있는 문제가 있습니다.

> <img src="https://bakey-api.codeit.kr/files/3334/o6EhGH?name=%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2020-07-30+%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE+4.10.53.png">

> > test set에서만 성능이 좋을 수도 있고,

> <img src="https://bakey-api.codeit.kr/files/3334/WH1nla?name=%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2020-07-30+%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE+4.12.04.png">

> > 반대로 test set에서만 성능이 안 좋게 나올 수 있습니다.

- 교차 검증은 이러한 문제를 해결해 주는 방법입니다. 

## k겹 교차 검증
> k겹 교차 검증을 할 때는 먼저 전체 데이터를 k개의 같은 사이즈로 나눕니다. 예를 들어 k=5, 데이터가 총 1000개가 있다면 이 데이터를 200개씩 5개의 셋으로 나누는 거죠.
> <img src="https://bakey-api.codeit.kr/files/3334/6bi8xf?name=%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2020-07-30+%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE+4.12.22.png">
> 이 데이터 셋들을 이용해서 모델의 성능을 여러 번 검증합니다. 맨 처음에는 가장 위에 있는 데이터 셋을 test set으로 사용하고 나머지를 training set으로 사용합니다.

>  <img src="https://bakey-api.codeit.kr/files/3334/OxiaZU?name=%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2020-07-30+%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE+4.12.35.png">
> 그 다음에는 두 번째 데이터 셋을 test set으로 사용합니다. 나머지 4개의 training set으로 사용해서 다시 모델을 학습시키고, 성능을 파악합니다.

> <img src="https://bakey-api.codeit.kr/files/3334/8TZBo1?name=%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA+2020-07-30+%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE+4.12.44.png">
> 이 과정을 모든 데이터 셋에 반복해 줍니다. 그러면 5개의 테스트 셋에 대한 성능이 있을 텐데요, 이 성능 5개의 평균을 모델 성능으로 보는 겁니다.
> 모델의 성능을 여러 번 다른 데이터로 검증하기 때문에 평가에 대한 신뢰가 올라가는 거죠.
